# Bayesian Analysis for Hidden Markov Factor Analysis Models

## Metadata

- **Authors:** Yemao Xia, Xiaoqian Zeng, Niansheng Tang
- **Year:** 2018
- **Chapter:** 3
- **DOI:** http://dx.doi.org/10.5772/intechopen.72837
- **Keywords:** hidden Markov factor analysis model, Markov chain Monte Carlo sampling, cocaine use
- **Publisher:** IntechOpen
- **Source:** Chapter 3 in "New Insights into Bayesian Inference" (implied from page headers)
- **License:** Creative Commons Attribution License (CC BY 3.0)

## Abstract

The purpose of this chapter is to provide an introduction to Bayesian approach within a general framework and develop a Bayesian procedure for analyzing multivariate longitudinal data within the hidden Markov factor analysis framework.

## 1. Introduction

The Bayesian approach is now well recognized in the statistics literature as an attractive approach to analyzing a wide variety of models [1], and there is rich literature on this issue. Here, we are not going to present a full coverage on the general Bayesian theory, and readers may refer to excellent books, for example [2, 3], for more details for this general statistical method. This chapter provides an introduction to the Bayesian approach within a general framework and develops a specific Bayesian procedure for analyzing multivariate longitudinal data within the hidden Markov factor analysis framework. We begin with the basic ideas of the Bayesian approach and then describe the model under consideration in the second section. The following section considers Bayesian inferences including parameter estimation, model selection, and posterior density estimates. The final section demonstrates the practical value of proposed methodology to cocaine use data to get some Bayesian results. Some technical details are given in the Appendix.

Consider a data set Y with the probability model p(Y|θ) where θ is a univariate or multivariate population parameters vector, which quantifies the uncertainty of data. In the statistical literature, p(Y|θ) is called likelihood or sampling distribution and often represented as L(θ). From the frequency statistics point of view, statistical inferences are carried out based on L(θ). In this case, θ, though unknown, is treated as fixed. Unlike the frequency statistical inferences, the Bayesian approach for data analysis assumes that θ is random and has a distribution π(θ). This distribution, which represents the knowledge about θ, is referred to as prior distribution or prior. When data are available, the information on θ is summarized within the posterior distribution or posterior, a conditional distribution θ given data, i.e.,

p(θ|Y) = p(Y|θ)π(θ) / p(Y) ∝ p(Y|θ)π(θ) (1)

where p(Y) = ∫ p(Y|θ)π(θ)dθ is the marginal distribution of Y. The right-hand-side term in (1) omits the factor p(Y) since given Y it is a known constant. In Bayes literature, p(Y|θ)p(θ) is also termed the unnormalized posterior. Analogous to the role of likelihood in frequency statistical inferences, posterior is the starting point of Bayesian inferences.

Selecting proper priors for parameters is fundamental to Bayesian analysis. Basically, there are two kinds of prior distributions, namely, the noninformative prior distributions and the informative prior distributions. Noninformative prior distributions associate with situations when the prior distributions have no population basis. They are used when we have little prior information on θ and desire that the prior distributions play a minimal role in the posterior distribution distribution. Informative prior distribution represents the distribution of possible parameter values, from which the parameter θ has been drawn. We may have prior knowledge about this distribution, either from closed related data or from the subjective knowledge of experts. A commonly used informative prior distribution in the general Bayesian approach to statistical problems is the conjugate prior distribution, a prior ensuring that the posterior distribution follows the same parametric form as the prior distribution [1, 3].

A potential difficulty underlying Bayesian inferences is the statistical computation when posterior distribution takes on the complicated form. This is particularly true in the situation where latent variables or other unobservable quantities are involved in the model, as discussed in this chapter. In such cases, statistical inferences usually recur to simulation-based methods. Among various sampling methods, Markov chains Monte Carlo methods (MCMC) provide powerful tools for simulating observations from posterior. The key to Markov chain simulation is to create a Markov sequence whose stationary distribution is a specified posterior p(θ|Y). Posterior inferences are carried out based on these simulated observations. There are many ways of constructing these Markov chains, but all of them, including the Gibbs sampler [4, 5], are special cases of the general framework of Metropolis et al. [6] and Hastings [7]. However, we do not intend to pursue this issue here, and details on simulation-based methods can be referenced to [2, 3, 8, 9].

In what follows, as an illustration, we will develop a Bayesian analysis procedure for multivariate data under longitudinal setting. Multivariate longitudinal or clustered data occur when multiple items are measured repeatedly over periods of time or across occasions. Under such setting, the primary interest is inference about the dependence of the multiple measurements and the temporal correlation resulting from the repeated measures on the same items. But more often, particular interest also focuses on exploring the potential heterogeneity of data and investigating its transition pattern over time. In these cases, hidden Markov latent variable model (HMLVM) [10–13] provides a feasible and unified framework to address these issues. HMLVM assumes that the overall model constitutes the observed process and the underlying hidden state process. The state process, as the convention in the classic HMM (see for example, [14-17]), is an univariate discrete process, which follows a first-order Markov chain, while the observed process, conditional on the state sequence, is an independent process with emission distribution specified via LVMs [18]. Hence, in this regard, HMLVM provides a unified way of describing the correlation of multiple items, temporal dependence, and heterogeneity among the data simultaneously. However, the current existing developments cited beforehand focus on the maximum likelihood analysis in which statistical inferences heavily depend on the asymptotic properties. As an illustration of Bayesian inferences on practical problems, in this chapter, we develop a Bayesian procedure to analyze cocaine use data within the hidden Markov factor analysis model framework. Compared to ML, a basic nice feature of a Bayesian approach is its flexibility to utilize useful prior information for achieving better results. Additionally, simulation-based Bayesian methods depend less on asymptotic theory and hence have the potential to produce more reliable results even with small samples.

## 2. Model description

### 2.1. Hidden Markov factor analysis model

Consider a set of multivariate longitudinal observations formed by p-dimensional observed vectors **y**\_it = (y_it1, ..., y_itp)', which are recorded on p items over periods of length T: t = 1, …, T across N subjects: i = 1, …, N. In the field of multivariate analysis, interest mainly focuses on exploring item dependence since measurements may be highly correlated arising from the multicollinearity problem. But more often, interest also concentrates on the heterogeneity resulting from the situation where the population of **y**\_it constitutes more than one component. This is particularly true in the situation where the data illustrate extreme behaviors such as multimodal and/or skewed characteristics. In these cases, a finite mixture factor analysis model (FMFAM) can provide a powerful tool to address these issues. Typically, FMFAM assumes that conditioning on an univariate discrete value state variable z_it and an m-dimensional (m < p) continuous latent factor vector **ω**\_it, **y**\_it are independent and distributed with a p-dimensional multivariate normal distribution, and meanwhile, given z_it, **ω**\_it also follows an m-dimensional normal distribution, that is,

{ (**y\***it | **ω**\_it, z_it = r) ~ N_p(**μ**\_r + **Λ**\_r **ω**\_it, **Ψ\***εr)
{ (**ω**\_it | z_it = r) ~ N_m(**0**, **Φ**\_r) } (2)

where **μ\***r = (μ*r1, ..., μ_rp)' is a p-dimensional intercept vector, which represents the baseline level of **y**\_it, **Λ**\_r = (**Λ**'\_r1, ..., **Λ**'\_rp)' is a p × m factor loading matrix, **Ψ\***εr = diag{ψ*εkr1, …, ψ*εkrp} is a p × p diagonal matrix with the jth diagonal element ψ*εkrj > 0, and **Φ**\_r is an m × m positive definite matrix.

Formulation given in (2) has two basic features: one is to characterize heterogeneity of population of **y**\_it at the occasion level and the other is to establish the dependence among the multiple measurements. The heterogeneous population is specified via state-specific parameters contained in the model while the dependence between different measurements is identified via sharing the common factors in the manner of liner combinations. In particular, apart from explaining the idiosyncratic part of measurements, latent factors also characterize the association between any two measurements. As a matter of fact, one can show that the correlation coefficient between y_itj and y_itk at state z_it is given by

Corr (y*itj, y_itk | z_it = r) = [ Σ*(l=1)^m Σ*(h=1)^m Λ_rjl Λ_rkh Φ_rlh ] / [ √(Σ*(l=1)^m Σ*(h=1)^m Λ_rjl Λ_rjh Φ_rlh + ψ_erj) √(Σ*(l=1)^m Σ\_(h=1)^m Λ_rkl Λ_rkh Φ_rlh + ψ_erk) ] (3)

in which Λ_rjk is the (j, k)th element of **Λ**\_r and Φ_r,hk is the (h, k)th element in **Φ**\_r respectively. The strength of correlation is identified by the factor loadings and covariance of factors together. In the case when **ω**\_it degenerates to zero (i.e., **Φ** = **0**) or **Λ** = **0**, the association among items disappears and model (2) reduces to p-independent mean-variance models within cluster r. Hence, latent factors play a dominant role in characterizing association of multiple items. Note that, in actual applications, latent factors, though unobservable, often have their own physical interpretations. In psychology, for example, latent factors are often used to identify concepts such as treatment, temper, and anxiety, which are important within the framework of theoretical models. The measurements are just proxies for these unobserved concepts of interest. We will provide further interpretations in the real example.

The primary reason for collecting information on multiple occasions for each subject is that it allows investigation of change and/or temporal dependence over time within the subject. There exist various constructs for characterizing dynamic characteristics. A commonly used method is to construct proper dynamic structures for latent factors and establish dynamic factor models, see for example, [19–21]. An alternative choice we adopt here is specifying the joint distribution for state sequences. Following the common routine (see, for example, [22, 23]), we assume that each individual state sequence **z**\_i = (z_i1, …, z_iT) satisfies the following first-order hidden Markov model

p(**z**_i) = p(z_i1) Π_(t=2)^T p(z_it | z_i,t-1) (4)

where p(z_i1) and p(z_it|z_i, t−1) are, respectively, the initial distribution and transition probability given by

P(z_i1 = r) = δ_r, P(z_it = s|z_i, t−1 = r) = Q_rs (r, s = 1, …, S) (5)

where S is a positive integer, **δ** = (δ*1, …, δ_S)' is an S × 1 vector satisfying δ_r ≥ 0 and Σ*(r=1)^S δ*r = 1.0, and **Q** = (Q_rs) is an S × S transition matrix with the (r, s)th entry being Q_rs, that is, Q_rs ≥ 0 and Σ*(s=1)^S Q_rs = 1.0 for r = 1, …, S. Modeling state sequences into (5) allows us to explore the transition pattern of individuals across occasions exactly. For example, in the cocaine use data analysis, z_it is often identified with the latent state of patient i at time t, then Q_rs specifies how individual i being in state r transfers to state s on two successive occasions. Surely, we can relax the time-homogeneous assumption of transition probabilities by including relevant covariates to interpret the inhomogeneous transition behavior among observation data (see, for example, [12, 13, 16]) but at the expense of computational burden.

The current model defined in (2)–(5) provides a comprehensive framework for modeling the multivariate longitudinal data with the latent variables. It accommodates the dynamic behavior of observed sequences, heterogeneity of observed data at the occasion level, and dependence among the multiple items simultaneously. In particular, it makes sense to measure effects of latent factors on the manifest variables quantitatively.

Let **Y** be the collection of all observations, and **Ω** be the set of corresponding factors. Denote **Z** = {z_it : 1≤i≤N, 1≤t≤T} be set of state variables. It follows from Eqs. (2), (4) and (5) that the joint sampling distribution of **Y**, **Ω**, and **Z** is given by

p(**Y**, **Ω**, **Z**|**θ**, **δ**, **Q**) = Π*(i=1)^N [ p(**y**_i1, **ω**_i1 | z_i1, **θ**) p(z_i1|**δ**) ] Π*(t=2)^T [ p(**y**_it, **ω**_it | z_it, **θ**) p(z_it|z_i, t−1, **Q**) ]
∝ Π*(i=1)^N Π*(t=1)^T [ |**Ψ**_εz_it|⁻¹ᐟ² exp{-½ tr**Ψ**⁻¹_εz_it (**y**_it - **μ**_z_it - **Λ**_z_it **ω**_it)²} ]
× [ |**Φ**_z_it|⁻¹ᐟ² exp{-½ tr**Φ**⁻¹_z_it **ω**_it **ω**'_it} ]
× Π*(i=1)^N [ δ_z_i1 Π*(t=1)^T (Π*(r=1)^S Π*(s=1)^S Q_rs^I{z_i, t-1=r, z_it=s}) ] (6)

where θ is formed by free parameters in **μ\***r, **Λ**\_r, **Ψ\***εr, and **Φ**\_r. Here, we write a⊗2 = **a** **a**' and denote I(A) the indicator function of a set A. The observed data likelihood is then achieved by taking integration of p(**Y**, **Ω**, **Z**|**θ**, **δ**, **Q**) over **Ω** and **Z**, which involves high-dimensional integrations.

## 3. Posterior inferences

### 3.1. Prior specifications

Let **μ** = {**μ\***r}, **Λ** = {**Λ**\_r}, **Ψ\***ε = {**Ψ**\_εr}, and **Φ** = {**Φ**\_r}. For the Bayesian analysis, we need to assign priors to the unknown parameters involved for completing model specification. Since **θ**, **δ**, and **Q** are involved in different submodels, it is natural to assume that **θ**, **δ**, and **Q** are mutually independent and the components contained in **θ** are also mutually independent, that is,

p(**θ**, **δ**, **Q**) = p(**μ**)p(**Λ**, **Ψ**\_ε)p(**Φ**)p(**δ**)p(**Q**). (7)

For the convenience of conjugacy, we assume that the parameters are drawn from the following commonly used conjugate types prior distributions (see for example [24]).

p(**μ**) = Π*(r=1)^S p(**μ**\_r) = Π*(r=1)^S N*p(**μ**\_0r, **Σ**\_0r)
**Φ** ~ Π*(r=1)^S p(**Φ**_r) = Π_(r=1)^S W⁻¹\*m(**ρ**\_0r, **R**⁻¹\*0r)
p(**Λ**, **Ψ\***ε) = Π\*(r=1)^S p(**Λ**\_r | **Ψ\***εr) × p(**Ψ\***εr) = Π*(r=1)^S Π*(j=1)^p [ N_m(**λ**\_0rj, ψ*εrj **H\***ε0rj) ⋅ Ga⁻¹(α*ε0rj, β*ε0rj) ]
**δ**|**δ**₀ ~ Dir_S(γ₀, ..., γ₀)
p(**Q**) = Π\*(r=1)^S p(**Q**\_r) = Π\*(r=1)^S Dir_S(ν₀, ..., ν₀) (8)

where ‘Ga⁻¹(a, b)' denotes the inverse Gamma distributions with shape a > 0 and scale b > 0 and 'W⁻¹*m(ρ_0r, **R**⁻¹_0r)' represents the m-dimensional inverse Wishart distribution with ρ_0r degrees of freedom and (m × m) scale matrix **R**\_0r; **Q**\_r is the rth row vector of **Q**. The scalars α*ε0rj, β\*ε0rj, ρ_0r, γ₀, ν₀, the vectors **μ**\_0r, **λ**\_0rj, and the matrices **R**\_0r and **H\***ε0rj are assumed to be known. Thus, standard conjugate priors were specified for all parametric components in the model. The conjugate type prior distributions are sufficiently flexible in most applications, and for situations with a reasonable amount of data available, the hyperparameters scarcely affect the analysis. It should be noted that although Eq. (8) allows different hyperparameters for different latent states, in practice, we choose identical priors for all S. Details of hyperparameter choices are discussed later when we present the empirical results.

### 3.2. Gibbs sampling scheme and posterior analysis

Combining the sampling distribution for the observable **y**\_it's and the prior distribution specified in (8) yields the joint posterior distribution of { **θ**, **δ**, **Q**} given by

p(**θ**, **δ**, **Q**|**Y**) ∝ p(**Y**|**θ**, **δ**, **Q**)p(**θ**)p(**δ**)p(**Q**) (9)

where we ignore the normalization constant p(**Y**). However, due to the latent factors and state variables present, the computation of p(**Y**|**θ**, **δ**, **Q**) is intractable since it involves high-dimensional integrals. Consequently, no closed form can be available for the posterior p(**θ**, **δ**, **Q**|**Y**). This problem can be addressed via the data augmentation idea in Tanner and Wong [25]. Data augmentation technique treats the latent quantities {**Ω**, **Z**} as the hypothetical missing data and augments them with the observed data to form complete data. The posterior analysis is now carried out based on the joint distribution p(**Ω**, **Z**, **θ**, **δ**, **Q**|**Y**), which is proportional to p(**Y**, **Ω**, **Z**|**θ**, **δ**, **Q**)p(**θ**, **δ**, **Q**), the product of likelihood of complete data and priors. Compared to the intractable observed data likelihood, the complete data likelihood has nice hierarchical structure based on conditional independent assumptions in (2) and (4) and hence is relatively easy to analyze. However, p(**Ω**, **Z**, **θ**, **δ**, **Q**|**Y**) is still not in closed form and is thus difficult to deal with analytically. In this regard, simulation-based methods can be used to generate observations to carry out posterior analysis. In view of the multiple components involved, the usual independent sampling methods are not feasible. Note that, on the basis of complete data, the full conditional distributions of **Ω**, **Z**, **θ**, **δ**, and **Q** have closed forms. This provides a solid foundation for Markov chain Monte Carlo methods. Markov chain Monte Carlo sampling does not draw observations from p(**Ω**, **Z**, **θ**, **δ**, **Q**|**Y**) directly. On the contrary, it generates observations from the full conditionals of each component alternatively, thus forming the dependent sample, i.e., Markov chains. Specifically, as pointed out in the introduction, we use Gibbs sampler [4, 5] to draw observations from this target distribution. Obviously, the sampling scheme in the Gibbs sampler includes two types of moves: updating the components involved in the factor analysis model and updating the components related to the hidden Markov model. We propose using the following Gibbs sampler which iteratively simulates from the conditional distributions, where variables are removed from the conditioning set either by explicit integration or by conditional independence. The steps involved in the Gibbs sampler are:

- Step a: Generate **Z** from p(**Z**|**θ**, **δ**, **Q**, **Ω**, **Y**)
- Step b: Generate **Ω** from p(**Ω**|**Z**, **θ**, **Y**)
- Step c: Generate {**μ**, **Λ**, **Ψ\***ε} from p(**μ**, **Λ**, **Ψ\***ε|**Z**, **Ω**, **Y**)
- Step d: Generate **Φ** from p(**Φ**|**Z**, **Ω**)
- Step e: Generate **δ** from p(**δ**|**Z**)
- Step f: Generate **Q** from p(**Q**|**Z**)

Under mild conditions and similar to [4] (see also, for example, [26]), one can show that for sufficiently large b, say B₀, the joint distribution of {**Ω**⁽ᵇ⁾, **Z**⁽ᵇ⁾, **θ**⁽ᵇ⁾, **δ**⁽ᵇ⁾, **Q**⁽ᵇ⁾} converges at an exponential rate to the desired posterior distribution p(**Ω**, **Z**, **θ**, **δ**, **Q**|**Y**). Hence, p(**Ω**, **Z**, **θ**, **δ**, **Q**|**Y**) can be approximated by the empirical distribution of {**Ω**⁽ᵇ⁾, **Z**⁽ᵇ⁾, **θ**⁽ᵇ⁾, **δ**⁽ᵇ⁾, **Q**⁽ᵇ⁾} : b = B₀+1, …, B₀ + B} where B is chosen to give sufficient precision to the empirical distribution. The convergence of the Gibbs sampler can be monitored by the ‘estimated potential scale reduction (EPSR)' values as suggested by Gelman and Rubin [27] or by plotting the traces of estimates against iterations under different starting values.

Simulated observations obtained from the posterior can be used for statistical inferences via straightforward analysis procedures. For brevity, let {**θ**⁽ᵇ⁾, **δ**⁽ᵇ⁾, **Q**⁽ᵇ⁾, **Ω**⁽ᵇ⁾, **Z**⁽ᵇ⁾} be the random observations generated by the Gibbs sampler from p(**θ**, **δ**, **Q**, **Ω**, **Z**|**Y**). The joint Bayesian estimate of **θ** and **Ω** can be obtained easily via the corresponding sample means of the generated observations as follows:

**θ**̂ = (B − 1)⁻¹ Σ*(b=1)^B **θ**⁽ᵇ⁾, **Ω**̂ = (B − 1)⁻¹ Σ*(b=1)^B **Ω**⁽ᵇ⁾, **Z**̂ = (B − 1)⁻¹ Σ\_(b=1)^B **Z**⁽ᵇ⁾. (10)

Clearly, these Bayesian estimates are consistent estimates of the corresponding posterior means, see [26]. The consistent estimates of covariance matrix of estimates can be obtained as follows:

Cov(**θ**̂|**Y**) = (B – 1)⁻¹ Σ*(b=1)^B (**θ**⁽ᵇ⁾ – **θ**̂)(**θ**⁽ᵇ⁾ – **θ**̂)' (11)
Cov(**Ω**̂|**Y**) = (B – 1)⁻¹ Σ*(b=1)^B (**Ω**⁽ᵇ⁾ – **Ω**̂)(**Ω**⁽ᵇ⁾ – **Ω**̂)' (12)

Hence, the standard error estimates can be obtained conveniently by the Gibbs sampler algorithm. Other statistical inferences about **θ** and **Ω** such as deriving the confidence intervals and statistics for hypothesis testing can be achieved based on the simulative observations as well (see, for example, [28, 29]).

One important statistical inference beyond estimation is on testing of various hypotheses about the model. In the field of hidden Markov modeling, determining the proper number of states may be the first step towards data analysis. Too many states may overfit the observations, meaning that it can fit the training data accurately but may not be a good model for underlying data-generating process. On the other hand, too few states may not be flexible enough to approximate the underlying model. In the context of Bayesian model selection, Bayes factor (BF, [30]) is a popular choice for model comparison. BF is defined as the ratio of the marginal likelihoods of data under two competing models. However, the computation of BF is difficult since it often involves the high-dimensional integrations. It has also been shown that BF is sensitive to the choice of priors and will become infeasible when improper priors are used. A simple and more convenient alternative is the L_v-measures [31–34] which is based on the posterior predictive density. It has been shown [34] that this approach is conceptually and computationally simple and is useful in model checking for wide varieties of complicated situations. Moreover, the required computation is a by-product of the common Bayesian simulation procedures such as the Gibbs sampler or its related algorithms. Specifically, let **Y**^rep denotes future values of **Y** in a replicate experiment, that is, **Y**^rep has the same sampling density as that of **Y**. The posterior predictive distribution p(**Y**^rep|**Y**) is defined as

p(**Y**^rep|**Y**) = ∫ p(**Y**^rep|**θ**, **δ**, **Q**) p(**θ**, **δ**, **Q**|**Y**) d**θ** d**δ** d**Q** (13)

Naturally, if the posited model under consideration is the true model in the sense that from which the data are generated, then **Y**^rep would behave like data **Y** and its squared biases and covariances should be small. With this notion in mind, Ibrahim, Chen, and Sinha [34] proposed an L statistics to assess the fitness of posited models to the data by weighting the squared biases and covariance, which can be interpreted as a trade-off between them. Here, we extend it to the multivariate longitudinal setting. Let **Y**^rep = (**y**^rep₁', ..., **y**^rep_N')' be a collection set of future responses in our proposal. For some 0 ≤ v < 1, we consider the following multivariate version of L_v-measure:

L*v(**Y**) = Σ*(i=1)^N tr[Cov(**y**_i^rep|**Y**)] + v Σ\_(i=1)^N tr[{E(**y**_i^rep|**Y**) – **y**_i}{E(**y**_i^rep|**Y**) – **y**_i}'] (14)

where the expectation is taken with respect to the posterior predictive distribution. Clearly, small values of the L_v-measure indicate that the model gives predictions close to the observed values, and the variability in the predictions is low as well. Hence, the model with the smallest L_v-measure is selected from a collection of competing models. It has been shown that L_v-measure with v = 0.5 has nice theoretical properties [34]. Thus, this value of v will be used in our empirical illustrations.

## 4. Cocaine use data analysis

In this section, a small portion of cocaine use data is analyzed to illustrate the practical value of the proposed methodology. The original data are collected from 321 cocaine use patients who were admitted in 1988–1989 to the West Los Angeles Veterans Affairs Medical Center. The whole data constitute 68 measurements of 17 items, which were recorded at four time points: at baseline, 1 year after the treatment, 2 years after the treatment, and 12 years after the treatment in 2002–2003. These measurements cover the information on the cocaine use, treatment received, psychological problems, social status, employments, and so on. As an illustration, three variables are selected to conduct data analysis: ‘y₁ : days of cocaine use per month at intake (CC)', 'y₂ : times per month in formal treatment (FT)', and 'y₃ : months in formal treatment (MFT)', which, respectively, represent the severity of cocaine use and the levels of treatment received by a patient. Since these variables were measured in 0–120 points scale, to unify the scales, we take logarithms and standardize them. Among them, some measurements are missing. The missing proportion is about 8.4%. For brevity, we assume that the missing is missing at random [35]. A distinct characteristic underlying data are nonnormal and heavy tailed. **Figure 1** gives the plots of histograms and the posterior predictive density estimates (see below) of logarithms of CC, FT, and MFT (with missing data removed) on four occasions. The histograms illustrate that the distributions of selected variables are deviated from normality in terms of multimodality and skewness. The skewness and kurtosis of CC on four occasions are {-1.631, 5.031}, {-0.847, 3.354}, {0.328, 1.476}, and {-0.473, 2.467}, respectively. Data set also demonstrates dynamic characteristics. The distribution of CC, for instance, is skewed to the left at baseline and moves to the right gradually on the following two occasions and becomes right-skewed eventually. This implies that a single factor analysis model may not be appropriate to fit the data at each time point.

In this analysis, one of the objectives is to explore the effects of latent factors on the observed variables and assess the dependence among latent factors. Based on the nature of the problem under consideration, it is natural to group the single variable ‘CC' to reflect one latent factor ‘cocaine use' (η) and to group ‘FT' and ‘MFT' to represent another latent factor ‘treatment' (ξ). Let **y**\_it = (y_it1, y_it2, y_it3)' and **ω**\_it = (η_it, ξ_it)'. To be convenient for interpretation and computation, **Φ**\_r and **Λ**\_r are restricted to be invariant across states but leave the baseline level **μ**\_r varying with r. Further, the following non-overlapped structure for factor loading matrix is considered:

**Λ** = ( [1*, 0*], [0*, 1*], [0*, Λ₃₂] )' (15)

where parameters with an asterisk are treated as fixed for identification. Note that fixing Λ₁₁ = 1 indicates that η is identified with CC. This is similar to that in Λ₂₂. Hence, in this case, Φ₁₂ in **Φ** measures the magnitude of dependence of ξ on η.

Data set is fitted to the proposed models with 10 different transition models: S = 1, …, 10. Although these state spaces are in nested forms, the corresponding models are not, since one cannot be reduced to another by constraining parameters in the interior of parameter space. This indicates that chi-square distribution may not be suitable for the classic likelihood ratio test statistic. We use L-measure to implement model selection. Obviously, if S=1 is taken, then the proposed model reduces to common factor analysis model (CFA, [18]).

The following inputs are taken for the super-parameters involved in the prior distributions (8): for r = 1, …, S, **μ\***0rj = min{y_itj} + r/S, **Σ**\_0r = **S**\_yy/S, where **S**\_yy is the sample covariance matrix of data. The entries in **Λ**₀ are set to be zeros, ρ₀ = 10.0, **R**₀⁻¹ = 7.0 × **I**₂, which leads to the mean of **Φ** equal to **I**₂, **H\***ε0 = **I**₃, α*ε0j = 9.0, β*ε0j = 8.0, ν₀ = γ₀ = 0.1. Note that these values are the standard inputs in the latent variable analysis (see [24]). We also took other values for these inputs and found that the resulting estimates are scarcely affected.

We implement the proposed algorithm given in Section 3 to conduct Bayesian analysis. Let **Y**\_obs be the collection of observed data and **Y**\_mis be the set of missing data. Due to the missing data, we need to draw **Y**\_mis from p(**Y**\_mis|**Ω**, **Z**, **θ**, **Y**\_obs) in MCMC sampling. This can be implemented easily since conditioning on **Ω**, **Z**, and **θ**, p(**Y**\_mis|**Ω**, **Z**, **θ**, **Y**\_obs), independent of **Y**\_obs, has the normal distribution. Hence, drawing **Y**\_mis is rather straightforward and fast. To obtain some idea about the number of the Gibbs sampler iterations in getting convergence, we conducted a few test runs as a pilot study and found that in all these runs, the Gibbs sampler converged in about 1000-2000 iterations, where the EPSR values [27] are less than 1.2. So, for all cases under consideration, we collect 3000 random observations after initial 2000 iterations being removed for posterior analysis.

We calculate the values of L₀.₅ under each fitting. For computation, we use simulation-based method by drawing predictive values **Y**\_obs^rep from p(**Y**\_obs^rep | **Y**\_obs), where **Y**\_obs^rep is the hypothetical replication of **Y**\_obs. Note that p(**Y**\_obs^rep | **Y**\_obs) = ∫ p(**Y**\_obs^rep | **Ω**, **Z**, **θ**) p(**Ω**, **Z**, **θ**|**Y**\_obs) d**Ω** d**Z** d**θ**. Hence, drawing **Y**\_obs^rep is rather easy when **Ω**, **Z**, and **θ** are available. Given that we have M simulations from the posterior of **Ω**, **Z**, **θ** via MCMC sampling discussed before, we just draw one **Y**\_obs^rep from p(**Y**\_obs^rep | **Ω**, **Z**, **θ**) for each **Ω**, **Z**, and **θ** and obtain M simulations in the end for **Y**\_obs^rep. Based on these simulated observations, L_v measures can be estimated consistently via sample means. We draw 3000 observations after convergence of MCMC algorithm for calculating L₀.₅ and the results are reported in **Table 1**.

Examination of **Table 1** indicates that the proposed model with six to eight latent states seems to give better fits to the data. Furthermore, we calculate the posterior predictive density estimates of y_itj (t = 1, …, 4, j = 1, …, 3) under one state and seven states, respectively (see **Figure 1**). It can be seen clearly that our proposed method is successful in capturing the skewness and modes of data while factor analysis model fails. For the computation details, we choose 60–100 equally spaced grids in the interval [min{y_obs,itj} – 1.0, max{y_obs,itj} + 1.0] and collect 3000 simulated observations from the Gibbs sampler at each point after removing initial 2000 iteration as burn-ins.

**Table 2** presents the summary of Bayesian estimates of unknown parameters and their standard errors using the formula given in (11) with S = 1 (denoted by FA) and S = 7 (denoted by HMFA). For comparison, maximum likelihood estimates of unknown parameters with their standard deviations under HMFA are also presented in **Table 2**. The maximum likelihood analysis is conducted via MCECM algorithm [36] and the standard error estimates are calculated via Louis formula [37].

Based on **Table 2**, we can find the following facts: First, three estimates of Λ₃₂ give the positive effects of latent factor ξ on the ‘MFT'. This is not surprising since ξ is related to the treatment level of a patient received. But there are obvious differences in magnitudes among the three methods. For FA and HMFA, the former gives Λ̂₃₂ = 0.001 associated with standard deviation 0.014, while the latter gives Λ̂₃₂ = 0.752 with standard deviation 0.045. This reflects that the heterogeneity of data affects the estimates Λ₃₂ seriously. Compared to the previous two methods, ML method produces that Λ̂₃₂ = 0.196 with SD = 0.029, which are in between them. Second, the estimates of variance parameters ψ*εj under S = 1 are larger than those under S = 7. This indicates that factor analysis model accommodates heavy tails of data at the expense of variance inflation. Further investigations on the estimates of Φ_jj under FA and HMFA also reveal the same phenomenon as that of ψ*εj. However, we observe that the ML estimate of ψ*ε₃, the unique variance corresponding to the third item, is equal to 0.008 with SD = NAN, an illogical number, which is very close to an improper Heywood case. As pointed out by Lee [18], Heywood cases in the ML estimation can be avoided by imposing an inequality constraint on ψ*ε₃ with a penalty function. In the Bayesian approach, the conjugate prior distribution of ψ*ε₃⁻¹ specified ψ*ε₃ in a region of positive values and hence has a similar effect as adding a penalty function. Hence, no Heywood cases are found in the Bayesian solution because of the penalty function induced by the prior distribution on ψ_ε₃⁻¹. Third, three estimates give the negative correlation between η and ξ, which is consistent with the fact that the improvement of treatment will decrease the intensity of cocaine use, thus leading to a decrease of cocaine use in days. ML estimates for Φ_jk are very close to those under HMFA. However, the estimate of Φ₁₂ under S = 1 is −0.018, which is quite different from –0.182 for S = 7. Furthermore, the coefficients of correlation of ξ and η under S = 1 and S = 7 are –0.0204 and −0.6612, respectively. The former suggests that ξ and η are approximately independent while the latter implies stronger dependence between them.

Moreover, we computed the posterior probabilities P(z_t = r | **Y**\_obs) for r = 1, …, 7 and t = 1, …, 4 under S = 7 based on 10,000 simulated observations drawn from p(**Z**|**Y**\_obs) and found that the transition path corresponding to the maximum posterior probability is 7 → 1 → 1 → 1. This implies that latent state of the patient being in is extremely serious at baseline and becomes moderate in the subsequent treatments. This also reflects a positive effect of intervention on the patient's latent state. Note that unlike the common Viterbi algorithm in exploring the optimal transition path of states in ML analysis, calculating posterior probability P(z_t = r | **Y**\_obs) within Bayesian framework is a by-product of the estimation procedure. This voids the complex computation of marginal likelihood of the observed data and hence is very fast.

## Figure/Table Captions

**Figure 1.** Plots of histograms and posterior predictive density estimates of 'CC', 'FT' and 'MFT' under FA model and hidden Markov CFA model with seven states in the cocaine use data analysis: the dashed lines denote CFA and the solid lines represent the hidden Markov FA.

**Table 1.** Summary of L₀.₅ under competing models in the analysis of cocaine use data.

| Model | L₀.₅     | Model  | L₀.₅     |
| :---- | :------- | :----- | :------- |
| S = 1 | 2322.447 | S = 6  | 590.448  |
| S = 2 | 2107.514 | S = 7  | 572.172  |
| S = 3 | 1030.264 | S = 8  | 597.843  |
| S = 4 | 941.230  | S = 9  | 932.763  |
| S = 5 | 839.726  | S = 10 | 1030.264 |

**Table 2.** Summary statistics for Bayesian and ML estimates in the cocaine use data analysis.

| Para. | FA Est. | FA SD | ML Est. | ML SD | HMFA Est. | HMFA SD |
| :---- | :------ | :---- | :------ | :---- | :-------- | :------ |
| Λ₃₂   | 0.001   | 0.014 | 0.196   | 0.029 | 0.752     | 0.045   |
| ψ_ε₁  | 1.443   | 0.315 | 0.559   | 0.297 | 0.432     | 0.049   |
| ψ_ε₂  | 0.439   | 0.056 | 0.204   | 0.039 | 0.339     | 0.034   |
| ψ_ε₃  | 0.305   | 0.030 | 0.008   | NAN   | 0.025     | 0.001   |
| Φ₁₁   | 0.770   | 0.315 | 0.510   | 0.132 | 0.346     | 0.049   |
| Φ₁₂   | -0.018  | 0.018 | -0.053  | 0.041 | -0.182    | 0.052   |
| Φ₂₂   | 1.007   | 0.080 | 0.312   | 0.053 | 0.219     | 0.033   |

## 5. Discussion

This chapter reviews Bayesian inferences within a general framework and proposes a Bayesian procedure for analyzing hidden Markov factor analysis model under multivariate longitudinal setting. Compared to ML method, the pragmatic advantage of Bayesian framework is its flexibility and generality for coping with very complex problems. When good prior information can be available, results obtained from Bayesian method are more reliable and accurate than that under ML. With increased access to computation advances in simulation-based approaches, in particular the MCMC methodology, Bayesian inferences provide enormous scope for realistic statistical modeling.

Although we concentrate our attention on applications of the hidden Markov factor analysis model, the methodology developed in this chapter can be extended to the case where the LVM is nonlinear. Another possible extension is to consider a dynamic LVM, wherein model parameters vary over time. These extensions will raise theoretical and computational challenges and certainly require further investigation.

## Acknowledgements

The authors are grateful to the editor's valuable suggestions and comments which have greatly improved the manuscript. Xia's work was fully supported by grant from National Nature Science Foundation of China (No. 11471161) and Tang's work was supported by National Science Fund for Distinguished Young Scholars of China (No. 11225103).

## Author Details

- **Yemao Xia¹\***, Xiaoqian Zeng², Niansheng Tang³
- \*Address all correspondence to: ymxia@njfu.edu.cn
- 1 Department of Applied Mathematics, Nanjing Forestry University, Nanjing, China
- 2 School of Economics, Lanzhou University of Finance and Economics, Lanzhou, China
- 3 School of Mathematics and Statistics, Yunnan University, Kunming, China

## Appendix A. Full conditionals

**(a) p(Z|θ, δ, Q, Ω, Y)**

Let **ω**\_i denote the sequence of latent factors across T occasions for individual i. To draw state variables **Z** from p(**Z**|**δ**, **Q**, **θ**, **Ω**, **Y**), we first notice that

p(**Z**|**θ**, **Ω**, **Y**) = Π\_(i=1)^N p(**z**\_i | **ω**\_i, **δ**, **Q**, **θ**, **y**\_i) (16)

Hence, drawing **Z** can be accomplished via single-component method by drawing **z**\_i independently from p(**z**\_i | **ω**\_i, **δ**, **Q**, **θ**, **y**\_i). Furthermore, notice that the sequences {**y**\_i, **ω**\_i, **z**\_i} are still the one-order Markov sequences. Hence, we can simulate **z**\_i through a well-known forward filtering-backward sampling algorithm (see, for example, [38]). For notation clarity, we suppress **θ**, **δ**, and **Q** in the following derivations.

Forward filtering-backward sampling (FFBS) consists of first forward filtering (FF) and then backward sampling (BS). The forward filtering step recursively updates

α_i,t|t = p(z_it | **ω**\_i, 1:t, **y**\_i, 1:t), t = 1, ..., T. (17)

Here **y**\_i, 1:t represents the set of observations of subject i up to time t and so are **ω**\_i, 1:t and **z**\_i, 1:t. The backward sampling is to draw **z**\_i from the joint distribution of the states given the data using

p(**z**\_i, 1:T | **ω**\_i, 1:T, **y**\_i, 1:T) = p(z_iT | **ω**\_i, 1:T, **y**\_i, 1:T) ... p(z_i1 | **z**\_i, 2:T, **ω**\_i, 1:T, **y**\_i, 1:T). (18)

That is, we first draw the last state given all the data and then work backwards in time drawing each state conditional on all the subsequent ones.

To implement forward filtering, let

α_it(r) = P(**y**\_i, 1:t | **ω**\_i, 1:t, z_it = r), t = 1, …, T (19)

Obviously, α_i1(r) = δ_r p(**y**\_i1, **ω**\_i1 | z_i1 = r). Moreover, it can be shown that

α*it(r) = ( Σ*(s=1)^S α_i,t-1(s) q_sr ) p(**y**\_it, **ω**\_it | z_it = r), t = 2, ..., T (20)

The outputs {α*it}*(t=1)^T from recursive Eq. (20) can be used to calculate the posterior probability

α*i,t|t(r) = P(z_it = r | **ω**\_i, 1:t, **y**\_i, 1:t) = α_it(r) / Σ*(s=1)^S α_it(s) (21)

which leads to the forward filtering (FF) iteration.
The backward sampling step depends on the observation that

p(z_it | **z**\_i, t+1:T, **ω**\_i, 1:T, **y**\_i, 1:T) ∝ p(z_it, **z**\_i, t+1:T, **ω**\_i, 1:T, **y**\_i, 1:T)
= p(z_it, **ω**\_i, 1:t, **y**\_i, 1:t) p(**z**\_i, t+1:T, **ω**\_i, t+1:T, **y**\_i, t+1:T | z_it, **ω**\_i, 1:t, **y**\_i, 1:t)
= p(z_it | **ω**\_i, 1:t, **y**\_i, 1:t) p(**z**\_i, t+1:T | z_it, **ω**\_i, 1:t, **y**\_i, 1:t) p(**ω**\_i, t+1:T, **y**\_i, t+1:T | z_it, **z**\_i, t+1:T, **ω**\_i, 1:t, **y**\_i, 1:t)
= p(z_it | **ω**\_i, 1:t, **y**\_i, 1:t) p(**z**\_i, t+1:T | z_it) p(...) (22)

The last equation holds since given z_it, {**y**\_i, t:T, **ω**\_i, t:T, **z**\_i, t+1:T} does not depend on the previous values due to the Markov Chain characteristics of {y_it, ω_it, z_it}. This leads to

P(z*it = r | **z**\_i, t+1:T, **y**\_i, 1:T, **ω**\_i, 1:T) = [ α_i,t|t(r) q_r,z_i,t+1 ] / [ Σ*(s=1)^S α_i,t|t(s) q_s,z_i,t+1 ], t = T – 1, ..., 1. (23)

Hence, FFBS algorithm for drawing **z**\_i is implemented by
Algorithm:
i. running the recursion α_it and stored the conditional probabilities α_i,t|t for t = 1, ..., T;
ii. sampling z_iT from the filtered conditional probability α_i,T|T;
iii. for t = T – 1, …, 1, sampling z_it from the conditional probability P(z_it = r | **ω**\_i, 1:T, **y**\_i, 1:T, **z**\_i, t+1:T). (24)

**(b) p(Ω|Z, θ, Y)**

To draw **Ω**, we first note that

p(**Ω**|**Z**, **θ**, **Y**) = Π*(i=1)^N Π*(t=1)^T p(**ω**\_it | z_it, **θ**, **y**\_it) (25)

in which

p(**ω\***it | z_it, **θ**, **y**\_it) ∝ exp{ -½ (**y**\_it - **μ**\_r - **Λ**\_r **ω**\_it)' **Ψ**⁻¹\*εr (**y**\_it - **μ**\_kr - **Λ**\_r **ω**\_it) - ½ **ω**'\_it **Φ**⁻¹_r **ω**\_it } (26)

with r = z_it. Hence, similar to that in drawing **Z**, updating **Ω** can be achieved by drawing **ω**\_it independently from p(**ω**\_it | z_it, **θ**, **y**\_it) for i = 1, ..., N and t = 1, …, T. It can be shown that

p(**ω**\_it | z_it = r, **θ**, **y**\_it) = N_m(**m**\_it, **Σ**\_r). (27)

in which

**m\***it = **Σ**\_r **Λ**'\_r **Ψ**⁻¹\*εr (**y\***it - **μ**\_r), **Σ**\_r = (**Λ**'\_r **Ψ**⁻¹\*εr **Λ**\_r + **Φ**⁻¹_r)⁻¹. (28)

**(c) p(μ, Λ, Ψ_ε | Z, Ω, Y)**

To draw {**μ**, **Λ**, **Ψ\***ε}, we can first draw **μ** from p(**μ**|**Λ**, **Ψ\***ε, **Z**, **Ω**, **Y**) and then draw {**Λ**, **Ψ\***ε} from p(**Λ**, **Ψ\***ε|**μ**, **Z**, **Ω**, **Y**). For this end, let n⁽ʳ⁾ = #{z_it = r} be the size of cluster z_it, and let W_itr = I{z_it = r}. Denote

**Ȳ**⁽ʳ⁾ = ΣΣ W\*itr **y**\_it / n⁽ʳ⁾, **Ω̄**⁽ʳ⁾ = ΣΣ W_itr **ω**\_it / n⁽ʳ⁾,
**S**\_yy⁽ʳ⁾ = ΣΣ W_itr **y**\_it **y**'\_it / n⁽ʳ⁾, **S\***ωy⁽ʳ⁾ = ΣΣ W_itr **ω**\_it **y**'\_it / n⁽ʳ⁾, (29)

be the sample means and covariance matrices of **Y** and **Ω** within the rth cluster, respectively. By some algebra calculations, it can be shown that

p(**μ** | **Λ**, **Ψ**_ε, K, **Z**, **Ω**, **Y**) = Π_(r=1)^S p(**μ\***r | **Λ**\_r, **Ψ\***εr, **Z**, **Ω**, **Y**), and
p(**Λ**, **Ψ**_ε | **μ**, K, **Z**, **Ω**, **Y**) = Π_(r=1)^S p(**Λ\***r, **Ψ\***εr | **μ**\_r, **Ω**, **Z**, **Y**), (30)

where

p(**μ\***r | **Λ**\_r, **Ψ\***εr, **Z**, **Ω**, **Y**) = N\*p(**a\***μr, **Σ\***μr),
p(**Λ**\_r, **Ψ\***εr | **μ**_r, **Z**, **Ω**, **Y**) = Π_(j=1)^p [ p(ψ_εrj | **μ**_r, **Z**, **Ω**, **Y**) p(**Λ**_rj | ψ_εrj | **μ**_r, **Z**, **Ω**, **Y**) ]
= Π*(j=1)^p [ Ga⁻¹(a*εrj, b\*εrj) N*m(**a\***Λrj, ψ*εrj **H**\_rj) ], (31)

with

**a\***μr = **Σ\***μr [**Σ**₀r⁻¹ **μ**₀r + n⁽ʳ⁾ **Ψ**⁻¹_εr (**Ȳ**⁽ʳ⁾ - **Λ**_r **Ω̄**⁽ʳ⁾)], **Σ\***μr = (**Σ**₀r⁻¹ + n⁽ʳ⁾ **Ψ**⁻¹\*εr)⁻¹,
**a\***Λrj = **H**\_rj [**H**₀εj⁻¹ **λ**₀rj + n⁽ʳ⁾ (**S**⁽ʳ⁾*ωy(j) - **μ**'*rj **Ω̄**⁽ʳ⁾)], **H**\_rj = **H**₀εj⁻¹ + n⁽ʳ⁾ **S**⁽ʳ⁾*ωω
a*εrj = α*ε0rj + n⁽ʳ⁾/2,
b*εrj = β*ε0rj + ½ { **λ**'*0rj **H**₀εj⁻¹ **λ**₀rj + n⁽ʳ⁾ (**S**⁽ʳ⁾\_yy(j,j) - 2**μ**'\_rj **Ȳ**⁽ʳ⁾(j) + **μ**'\_rj **μ**\_rj) - **a**'\*Λrj **H\***rj⁻¹ **a\***Λrj } (32)

in which **Ȳ**⁽ʳ⁾(j) is the jth element in **Ȳ**⁽ʳ⁾, S⁽ʳ⁾*yy(j,j) is the jth main diagonal element of S⁽ʳ⁾\_yy, and S⁽ʳ⁾*ωy(j) is the jth column vector of S⁽ʳ⁾\_ωy.

**(d) p(Φ|Ω, Z)**

From the prior distribution of **Φ**\_r⁻¹ and the distribution of **Ω**, it can be shown that

p(**Φ\***r | **Ω**, **Z**) ∝ |**Φ**\_r|⁻⁽ⁿ⁽ʳ⁾⁺ρ₀ᵣ⁺ᵐ⁺¹⁾ᐟ² exp{ -½ tr**Φ**\_r⁻¹ [n⁽ʳ⁾**S**⁽ʳ⁾*ωω + **R**₀⁻¹] } (33)

where n⁽ʳ⁾ and **S\***ωω⁽ʳ⁾ are given in (c). Hence, p(**Φ**\_r | **Ω**, **Z**) is the m-dimensional inverse Wishart distribution W⁻¹_m(n⁽ʳ⁾ + ρ₀r, [n⁽ʳ⁾**S**⁽ʳ⁾*ωω + **R**₀⁻¹]⁻¹). It can be shown from exactly the same reasoning as before that drawing **Φ** can be achieved by drawing **Φ**\_r from p(**Φ**\_r | **Ω**, **Z**) independently.

**(e) p(δ|Z) and (f) p(Q|Z)**

It can be verified directly that

p(**δ**|**Z**) = p(**δ**\_k|**Z**) and
p(**δ**|**Z**) ~ Dir_S(γ₀ + n₁₁, ..., γ₀ + n₁S) (34)

in which n₁r = Σ\_(i=1)^N I{z_i1 = r}. Similarly, it can be shown that

p(**Q**|**Z**) = Π*(r=1)^S p(**Q**\_r | **Z**),
p(**Q**\_r | **Z**) = Π*(r=1)^S Dir_S(ν₀ + n_r1, ..., ν₀ + n_rs). (35)

in which n*rs = Σ*(i=1)^N Σ\_(t=2)^T I{z_i,t−1 = r, z_it = s}.

## References

[1] Berger JO. Statistical Decision Theory and Bayesian Analysis. New York: Springer-Verlag; 1985. DOI: 10.1007/978-1-4757-4286-2
[2] Box GEP, Tiao GC. Bayesian Inference in Statistical Analysis. Reading, MA: Addison-Wesley; 1973. DOI: 10.1002/9781118033197
[3] Gelman A, Carlin JB, Stern HS, Rubin DB. Bayesian Data Analysis. London: Chapman & Hall Ltd; 1995
[4] Geman S, Geman D. Stochastic relaxation, Gibbs distribution, and the Bayesian restoration of images. IEEE Transactions on Pattern Analysis and Machine Intelligence. 1984;(6):721-741. DOI: 10.1109/TPAMI.1984.4767596
[5] Gelfand AE, Smith AFM. Sampling-based approaches to calculating marginal densities. Journal of the American Statistical Association. 1990;85:398-409. DOI: 10.1080/01621459.1990.10476213
[6] Metropolis N, Rosenbluth AW, Rosenbluth MN, Teller AH, Teller E. Equations of state calculations by fast computing machine. Journal of Chemical Physics. 1953;21:1087-1091
[7] Hastings WK. Monte Carlo sampling methods using Markov chains and their application. Biometrika. 1970;57(1):97-109. DOI: 10.1093/biomet/57.1.97
[8] Robert CR, Casella G. Monte Carlo Statistical Methods. New York, Inc.: Springer-Verlag; 1999. DOI: 10.1007/978-1-4757-3071-5
[9] Ross SM. Simulations. Amsterdam: Academic Press/Elsevier, Inc.; 2013. DOI: 10.1016/B978-0-12-375686-2.00001-7
[10] Schmittmann VD, Dolan CV, Han LJ, van der Maas, Neale CM. Discrete latent Markov models for normally distributed response data. Multivariate Behavioral Research. 2005;40(4):461-488. DOI: 10.1207/s15327906mbr4004*4
[11] Xia YM, Gou JW, Liu YA. Semi-parametric Bayesian analysis for factor analysis model mixed with hidden Markov model. Applied Mathematics A Journal of Chinese Universities, Series A. 2015;30(1):17-30
[12] Song XY, Xia YM, Zhu HT. Hidden Markov latent variable models with multivariate longitudinal data. Biometrics. 2017;73(1):313-323. DOI: 10.1111/biom.12536
[13] Xia YM, Tang NS, Gou JW. Generalized linear latent model for multivariate longitudinal measurements mixed with hidden Markov model. Journal of Multivariate Analysis. 2017;152:259-275. DOI: 10.1016/j.jmva.2016.09.001
[14] Wiggings LM. Panel Analysis: Latent Probability Models for Attitude and Behavior Processes. San Francisco, CA: Elsevier Scientific; 1973
[15] Rabiner LR. A tutorial on hidden Markov models and selected applications in speech recognition. Proceedings of the IEEE. 1989;77(2):257-284. DOI: 10.1109/5.18626
[16] Altman RM. Mixed hidden Markov models: An extension of the hidden Markov mode to the longitudinal data setting. Journal of the American Statistical Association. 2007;102(477):201-210. DOI: 10.1198/016214506000001086
[17] Maruotti A. Mixed hidden Markov models for longitudinal data: An overview. International Statistical Review. 2011;79(3):427-454. DOI: 10.1111/j.1751-5823.2011.00160.x
[18] Lee SY. Structural Equation Modelling: A Bayesian Approach. New York: John Wiley & Sons; 2007
[19] Dunson DB. Dynamic latent trait models for multidimensional longitudinal data. Journal of the American Statistical Association. 2003;98(463):555-563. DOI: 10.1198/016214503000000387
[20] Zhang ZY, Hamaker EL, Nesselroade JR. Comparisons of four methods for estimating a dynamic factor model. Structural Equation Modeling: A Multidisciplinary Journal. 2008;(3, 377):377-402. DOI: 10.1080/10705510802154281
[21] Chow SY, Tang NS, Yuan Y, Song XY, Zhu HT. Bayesian estimation of semiparametric nonlinear dynamic factor analysis model using the Dirichlet prior. British Journal of Mathematical and Statistical Psychology. 2011;64:69-106
[22] Ebbes P, Grewal R, DeSarbo WS. Modeling strategic group dynamics: A hidden Markov approach. Quantitative Marketing and Economics. 2010;8:241-274
[23] Marruotti A. Robust fitting of hidden Markov regression models under a longitudinal data. Journal of Statistical Computation and Simulation. 2014;84:1728-1747
[24] Zhu HT, Lee SY. A Bayesian analysis of finite mixtures in the LISREL model. Psychometrika. 2001;66(1):133-152. DOI: 10.1007/BF02295737
[25] Tanner MA, Wong WH. The calculation of posterior distributions by data augmentation (with discussion). Journal of the American Statistical Association. 1987;82(398):528-550. DOI: 10.1080/01621459.1987.10478458
[26] Geyer CJ. Practical Markov chain Monte Carlo. Statistical Science. 1992;7(4):473-511. DOI: 10.1214/ss/1177011137
[27] Gelman A, Rubin DB. Inference from iterative simulation using multiple sequences (with discussion). Statistical Science. 1992;7(4):457-511. DOI: 10.1214/ss/1177011136
[28] Besage J, Green P, Higdon D, Mengersen K. Bayesian computation and stochastic system. Statistical Science. 1995;10(1):3-66. DOI: 10.1214/ss/1177010123
[29] Gelman A. Inference and monitoring convergence. In: Gilks WR, Richardson S, Spiegelhalter DJ, editors. Markov Chain Monte Carlo in Practice. London: Chapman and Hall; 1996. pp. 131-140
[30] Kass RE, Raftery AE. Bayes factor (with discussion). Journal of the American Statistical Association. 1995;90(430):773-795. DOI: 10.1080/01621459.1995.10476572
[31] Geisser S, Eddy W. A predictive approach to model selection. Journal of the American Statistical Association. 1979;74(365):153-1160. DOI: 10.1080/01621459.1979.10481632 (\_Note: page range seems incorrect in OCR, likely 153-160*)
[32] Laud PW, Ibrahim JG. Predictive model selection. Journal of the Royal Statistical Society, Series B. 1995;57(1):247-262. DOI: 10.2307/2346098
[33] Gelfand AE, Ghosh SK. Model choice: A minimum posterior predictive loss approach. Biometrika. 1998;85(1):1-13. DOI: 10.1093/biomet/85.1.1 (_Note: page range seems incorrect in OCR, likely 1-13_)
[34] Ibrahim JG, Chen MH, Sinha D. Criterion based methods for Bayesian model assessment. Statistica Sinica. 2001;11:419-443
[35] Little RJA, Rubin DB. Statistical Analysis with Missing Data. New York: Wiley; 1987. DOI: 10.1002/9781119013563
[36] Wei GCG, Tanner MAA. Monte Carlo implementation of the EM algorithm and the poor man's data augmentation algorithms. Journal of the American Statistical Association. 1990;85:699-704
[37] Louis TA. Finding the observed information matrix when using the EM algorithm. Journal of the Royal Statistical Society, Series B. 1982;44:226-233
[38] Cappé O, Moulines E, Rydén T. Inference in Hidden Markov Models. New York: Springer Verlag; 2005
